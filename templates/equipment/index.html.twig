{% extends 'base.html.twig' %}

{% block title %}Equipment List
{% endblock %}

{% block body %}
	{% include '_partials/_adminav.html.twig' %}
		{% include '_partials/_flush.html.twig' %}

	<main class="flex flex-col gap-4 md:gap-5 px-4 lg:px-5 lg:ml-56 h-auto pt-20 pb-5">
		<div class="px-6 py-8 lg:px-8">
			<div class="sm:flex sm:items-center mb-6">
				<div class="sm:flex-auto">
					<h1 class="text-xl font-semibold text-gray-900">Equipment</h1>
				</div>
				<div class="mt-4 sm:mt-0 sm:ml-16 sm:flex-none">
					<a type="button" href="{{ path('equipment_new') }}" class="inline-flex items-center justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:w-auto">Add equipment</a>
				</div>
			</div>

			<div class="bg-white shadow overflow-hidden sm:rounded-lg">
				<table class="min-w-full divide-y divide-gray-200">
					<thead class="bg-gray-50">
						<tr>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
							{# <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> User</th> #}
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Model/SN</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
								Date</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quantity</th>
							{# <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th> #}
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Price</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
						</tr>
					</thead>
					<tbody class="bg-white divide-y divide-gray-200">
						{% for equipment in equipments %}
							<tr>
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ equipment.id }}</td>
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ equipment.name }}</td>
								{# <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
								                                    {{ equipment.assignedUser ? equipment.assignedUser.name : 'None' }}
								                                </td> #}
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
									<div>
										{# {{ equipment.brand }}  #}
										{{ equipment.model }}</div>
									<div class="text-sm text-gray-400">
										{{ equipment.serialNumber }}</div>
								</td>
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
									{{ equipment.purchaseDate|date('d-m-Y') }}
									<div>
										{{ equipment.warrantyDate|date('d-m-Y') }}
									</div>
								</td>
								<td class="px-6 py-4 whitespace-nowrap text-sm">
									<span class="inline-flex rounded-full px-2 text-xs font-semibold leading-5
											                                        {% if equipment.status == 'active' %}
											                                            bg-green-100 text-green-800
											                                        {% elseif equipment.status == 'expired' %}
											                                            bg-red-100 text-red-800
											                                        {% elseif equipment.status == 'obsolete' %}
											                                            bg-yellow-100 text-yellow-800
											                                        {% endif %}">
										{{ equipment.status }}
									</span>
								</td>
								{# <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
									<span class="inline-flex rounded-full px-2 text-xs font-semibold leading-5
											                                        {% if equipment.quantity > 0 %}
											                                            bg-green-100 text-green-800
											                                        {% elseif equipment.quantity == 0 %}
											                                            bg-red-100 text-red-800
											                                        {% endif %}">
										{{ equipment.quantity }}</td>
								</td> #}
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
									<div class="text-sm text-gray-400">
										S : {{ equipment.stockQuantity }}
										
									</div>

									<div class="text-sm text-gray-400">
										R :{{ equipment.reservedQuantity }}

									</div>
								</td>
								{# <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ equipment.reservedQuantity }}</td> #}
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ equipment.price }}
									GNF</td>
								<td class="px-4 py-2">
									<a href="{{ path('equipment_show', {'id': equipment.id}) }}" class="text-blue-600 hover:underline">
										<i class="fas fa-eye"></i>
									</a>
									|
									<a href="{{ path('equipment_edit', {'id': equipment.id}) }}" class="text-yellow-600 hover:underline">
										<i class="fas fa-edit"></i>
									</a>
									|

									<form action="{{ path('equipment_delete', {'id': equipment.id}) }}" method="post" class="inline-block">
										<input type="hidden" name="_token" value="{{ csrf_token('equipment_delete_' ~ equipment.id) }}">
										<button type="submit" class="text-red-600 hover:underline" onclick="return confirm('Are you sure?');">
											<i class="fas fa-trash"></i>
										</button>
									</form>
								</td>
							</tr>
						{% else %}
							<tr>
								<td colspan="9" class="px-6 py-4 text-center text-sm text-gray-500">
									No movements found.
								</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</main>
{% endblock %}
