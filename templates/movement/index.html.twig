{% extends 'base.html.twig' %}

{% block title %}Movement List
{% endblock %}

{% block body %}
	{% include '_partials/_adminav.html.twig' %}
	{% include '_partials/_flush.html.twig' %}
	<main class="flex flex-col gap-4 md:gap-5 px-4 lg:px-5 lg:ml-56 h-auto pt-20 pb-5">
		<div class="px-6 py-8 lg:px-8">
			<h1 class="text-3xl font-bold text-blue-900 mb-6">Movements</h1>
			<a href="{{ path('movement_new') }}" class="inline-block bg-indigo-600 text-white py-2 px-4 rounded-md shadow-sm hover:bg-indigo-700 mb-4">
				<i class="fa-solid fa-plus"></i>
				Add Movement
			</a>
			<div class="bg-white shadow overflow-hidden sm:rounded-lg">
				<table class="min-w-full divide-y divide-gray-200">
					<thead class="bg-gray-50">
						<tr>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quantity</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Equipment</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Quantity</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User</th>
							<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
						</tr>
					</thead>
					<tbody class="bg-white divide-y divide-gray-200">
						{% for movement in movements %}
							<tr>
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ movement.id }}</td>
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
									<span class="inline-flex rounded-full px-2 text-xs font-semibold leading-5
											{% if movement.type == 'IN' %}
											bg-green-100 text-green-800
												{% elseif movement.type == 'OUT' %}
											bg-red-100 text-red-800
											{% endif %}">
										{{ movement.type }}</td>
								</td>
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">{{ movement.quantity }}</td>
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">{{ movement.equipment.name }}</td>
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">
									<span class="inline-flex rounded-full px-2 text-xs font-semibold leading-5
											{% if movement.equipment.stockQuantity > 0 %}
											bg-green-100 text-green-800
											{% elseif movement.equipment.stockQuantity == 0 %}
											bg-red-100 text-red-800
											{% endif %}">
										{{ movement.equipment.stockQuantity }}</td>
								</td>
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">{{ movement.movementDate|date('Y-m-d') }}</td>
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">{{ movement.category ? movement.category.name : 'N/A' }}</td>
								<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">{{ movement.user ? movement.user.name : 'N/A' }}</td>
								<td class="px-4 py-2">
									<a href="{{ path('movement_show', {'id': movement.id}) }}" class="text-blue-600 hover:underline">
										<i class="fas fa-eye"></i>
									</a>
									|
									<a href="{{ path('movement_edit', {'id': movement.id}) }}" class="text-yellow-600 hover:underline">
										<i class="fas fa-edit"></i>
									</a>
									|
									<a href="{{ path('movement_delete', {'id': movement.id}) }}" class="text-red-600 hover:underline" onclick="return confirm('Are you sure?');">
										<i class="fas fa-trash"></i>
									</a>
								</td>
							</tr>
						{% else %}
							<tr>
								<td colspan="9" class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">No movements found.</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</main>
{% endblock %}
